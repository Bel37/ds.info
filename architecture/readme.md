# Документация модуля "Реестр гражда" проекта "Мэта-Беларусь"
Дисклеймер тут разрозненно.
[Освноная схема со всем скоупом тут](./crdesign.drawio)

## Общее описание
Делаем систему со множеством способов верификации - один (через знакомых) будет основной.
Способы можно будет «врубать» в любом порядке. Сторонние сервисы смогут как добавлять «теги» верификации свои, так и запрашивать определенные теги для того чтобы аккаунт мог этими сервисами пользоваться.
В том числе обсуждаем механизм периодической реверификации аккаунтов как дополнительный способ борьбы с дублями.

Использование паспортов исключили - в нашем случае не надежно и никто не будет свои паспорта засовывать в непонятную систему. Более того беларуский паспорт без 5 минут менее легальная бумажка чем запись в нашем ещё не существующем реестре.


Принципы от которых мы сейчас отталкиваемся:
1. ввиду правового дефолта любые документы выпущенные на территории РБ на данный момент не имеют долгосрочной юридической силы и могут быть использованы злоумышленниками для компрометирование системы (например МВД может в любой момент наштамповать паспортов для мертвых душ любого KYC или анулировать ваш паспорт)
2. мы исходим из того что когда победим, такая децентрализованная система которая никому не доверят будет иметь смысл, просто хотябы что бы второй Лукашенко был невозможен
3. отключите пожалуйста все привычки в вопросах документов и верификации - они будут мешать думать ввиду первых двух предпосылок
4. Это очень маленький и „тонкий” модуль который является децентрализованным хабом без центрального владельца
5. Т.к. у нас мало ресурсов все функции в ресстре редуцированы до авторизации людей и сервисов
6. К реестру могут быть подключены любые сервисы которые выбирут пользователи \ граждане — в том числе и те самые реестры про которые вы говорите. И репликация данных из них уже больше даже головняк тех кто будет их подключать.
7. Подключение и отключение к реестру как системе авторизации какого либо сервиса - результат волеизъявления граждан \ пользователей.

В реестр из коробки будет зашита функция регистрации через приглашения и кросс подтверждения, скорее как способ бутстрапа и как возможность работать автономно в случае какого либо колапса внешних систем или же потери к ним доверия со стороны граждан.

## Базовые требования к алгоритмам (english)
1. “6 handshakes” is a real thing: 1st level - 100 requests, 2 has 35 requests, 3 has 15 requests, 4 has 5 requests, 5 has 5 requests in 2 months, then +1 request every 2 months (max 5)
2. People can be asked to set multiple geo locations. To mark the places where they have most friends.
3. 1 level requests can not require confirmations
    1. 1 level - 0 confirmation
    2. 2 level - 1 confirmation
    3. 3 level - 3 confirmations
    4. 4+ - 5 confirmations
4. Confirmation requires providing of private data
    1. Security implications in the yabat’ka context (can be turned into adoption mechanics) 
        1. Yebat’ka can be motivated to invite his or her real people 
    2. Providing of private date is a private data protection condition for some countries (GDPR)
        1. Private data can be deleted later

5. Request of non belarusian citizens should be marked
    1. Non Belarusian citizen can’t invite people
    2. To think if he or she may invite other non Belarusian citizens
    3. Non Belarusians can’t vote for services and participate in such voting
    4. Non Belarusians can’t confirm Belarusians 
    5. Non Belarusians has nationality marker, that define their scope of requests and confirmations
    6. Non Belarusians required to become valudators
    7. It’s a crime - to invite non Belarusian as Belarusian

## Проблемы с системой подтверждения аккаунтов
1. Человек при оформлении профиля указывает точки на карте где его должны знать много людей (дворы, места работы, учебы и т.д.) и личные - [данные зашифрованы его собственным ключем, чтобы никто не пугался]
  1. Точки вводятся вместе с интарвалами дат когда человек там чаще всего появлялся
  2. Всю эту кухню можно условно назвать "Распределённая историческая регистрация" (но название не так важно, чтобы аналогия была понятно что это)
2. Затем система рассылает приглашения подтвердить человека следующим образом:
  1. Выбираются точки ближайшие во времени
	2. Выбираются точки других пользователей ближайшие во времени
	3. Выбираются наиболее активные пользователи
	4. Выбираются пользователи у которых больше всего осталось жетонов подтверждения (жетоны подтверждения и приглашения периодически автопополняются, приглашений 5 в год, подтверждений 25 в год)
	5. По формуле с весами делается рейтинг "близости и активности"
	6. Раз в пол дня если подтверждения не были получены, запрос на подтверждение уходит дополнительному числу людей, а радиус поиска вокруг "точек исторической регистрации" расширяется.
	7. Наиболее "Близким и активным" приходят уведомления для подтверждения что такое человек действительно там встречался
    1. Для этого только люди которым пришли данные на подтверждение могут их расшифровать и посмотреть
		1. Так же тот кто стал верификатором может выставить флаги: например что такое человек уже регистрировался
	8. После получения необходимого числа подтверждений аккаунт активируется
	9. Если аккаунт не может собрать нужное число подтверждений (но не менее одного обязательного) таким образом, через 2 недели разлочивается возможность разослать запросы на подтверждение знакомым
3. Аккаунты участвующие в приглашении и активации какого-либо аккаунта связываются с ним
  1. Стороннии сервисы подключенные к реестру могут маркеровать аккаунты которые учавствуют в создании твинков (дублей) так же они могут, в том числе и связанные аккаунты
  2. Так же эти сторонии сервисы могут отключать аккаунтам втянутым в дублицирование возможность рассылать приглашения и конфирмить созданные по ним аккануты, как временно так и перманенто (про внешние сервисы и как они будут попадть в систему смотрите диаграмму с гитхаба - это отдельный блок реестра)
4. Так же верифицированные сторонии сервисы смогут заводить и подтверждать пользователей без всех этих заморочек
  1. Надо напомнить что такие сервисы не могут быть единственным путём в ближайшее время пока мы находимся в революционной ситуации
		 
Что нужно доработать в идее:
1. Система подверждений кажется что никуда не годится:
  1. По различным причинам малознакомые люди, которые даже помнят тебя в лицо (не то что по фамилии) могут игнорировать такие штуки
	2. Это и сам принцип расширения поиска твоих истинных "знакомых" может отнимать много времени
	3. При этом, судя по всему, тут будут самые сложные алгоритмы реестра
  4. Проблема на начальном этапе частично решается тем, что посевные аккаунты и два проивзодных уровня "поручительства" будут обладать другими типами приглашений с более лайтовыми условиями (см. ссылку на pdf) спасибо Jodako за идею (мы ее немного доработали)
	5. В решении кажется есть излишние шаги которые не дают дополнительной защиты (алгоритм бы через теорию игр проверить)
2. Нужно описание интерфейса взаимодействия (user-flow) в первую очередь которые бы прятали от конечного пользователя большую часть гемороя с этим связанного - а то процесс будет тяжелым к воспроизведению 